<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib/checkbox-events.js - itsa-checkbox</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="https://avatars0.githubusercontent.com/u/8314644?v=3&amp;s=84" title="itsa-checkbox"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.1</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Checkbox.html">Checkbox</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/itsa-react-checkbox.html">itsa-react-checkbox</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: lib/checkbox-events.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&quot;use strict&quot;;

/**
 * React-Component: iOS-stylish checkbox.
 *
 *
 *
 * &lt;i&gt;Copyright (c) 2016 itsasbreuk - http://itsasbreuk.nl&lt;/i&gt;&lt;br&gt;
 * New BSD License - http://choosealicense.com/licenses/bsd-3-clause/
 *
 *
 * @module itsa-react-checkbox
 * @class Checkbox
 * @since 2.0.0
*/

import domUtils from &quot;./dom-utils&quot;;
import ReactDOM from &quot;react-dom&quot;;

const MAIN_CLASS_PREFIX = &quot;itsa-checkbox-&quot;,
      ON = &quot;on&quot;,
      MOUSE = &quot;mouse&quot;,
      MOUSEUP = MOUSE+&quot;up&quot;,
      MOUSEMOVE = MOUSE+&quot;move&quot;;

let IE8_Events;

const checkboxEvents = {

    /**
     * Gets invoked after the Component mounted.
     * Will set several refences to internal nodes for quick referal.
     *
     * @method componentDidMount
     * @since 0.0.1
     */
    componentDidMount() {
        const instance = this;
        instance._node = ReactDOM.findDOMNode(this);
        IE8_Events = !instance._node.addEventListener;
        instance._constrainNode = instance._node.querySelector(&quot;.&quot;+MAIN_CLASS_PREFIX+&quot;constrain&quot;);
        instance._containerNode = instance._node.querySelector(&quot;.&quot;+MAIN_CLASS_PREFIX+&quot;container&quot;);
        instance._btnNode = instance._node.querySelector(&quot;.&quot;+MAIN_CLASS_PREFIX+&quot;btn&quot;);
    },

    /**
     * Gets invoked before the Component gets unmounted.
     * Will detach some window-eventlisteners.
     *
     * @method componentWillUnmount
     * @since 0.0.1
     */
    componentWillUnmount() {
        this.detachDragEvents();
    },

    /**
     * Detaches some window-eventlisteners.
     *
     * @method detachDragEvents
     * @chainable
     * @since 0.0.1
     */
    detachDragEvents() {
        if (IE8_Events) {
            window.detachEvent(ON+MOUSEMOVE, this.handleMouseMove);
            window.detachEvent(ON+MOUSEUP, this.handleMouseUp);
        }
        else {
            window.removeEventListener(MOUSEMOVE, this.handleMouseMove, true);
            window.removeEventListener(MOUSEUP, this.handleMouseUp, true);
        }
        return this;
    },

    /**
     * Callback-fn for the onBlur-event.
     * sets internal &#x60;_focussed&#x60;-property false
     *
     * @method handleBlur
     * @since 0.0.1
     */
    handleBlur() {
        this._focussed = false;
    },

    /**
     * Callback-fn for the onClick-event.
     * Will invoke &#x60;this.props.onChange&#x60;
     *
     * @method handleClick
     * @since 0.0.1
     */
    handleClick() {
        const instance = this;
        if (!instance._wasDragged &amp;&amp; instance.props.onChange) {
            instance.props.onChange();
        }
        instance._wasDragged = false;
    },

    /**
     * Callback-fn for the onFocus-event.
     * sets internal &#x60;_focussed&#x60;-property true
     *
     * @method handleFocus
     * @since 0.0.1
     */
    handleFocus() {
        this._focussed = true;
    },

    /**
     * Callback-fn for the onKeyPress-event.
     * Will invoke &#x60;this.props.onChange&#x60; when the spacebar was pressed.
     *
     * @method handleKeyPress
     * @param e {Object} event-payload
     * @since 0.0.1
     */
    handleKeyPress(e) {
        if (this._focussed &amp;&amp; (e.charCode===32)) {
            this.handleClick();
        }
    },

    /**
     * Callback-fn for the onMouseDown-event.
     * Prepares for dragging the button.
     *
     * @method handleMouseDown
     * @param e {Object} event-payload
     * @since 0.0.1
     */
    handleMouseDown(e) {
        const instance = this;
        if (e.buttons===1) {
            instance._mousedown = true;
            instance._containerLeft = domUtils.getNodeLeft(instance._containerNode) - domUtils.getNodeLeft(instance._constrainNode);
            instance._mouseLeft = e.clientX;
            instance.setState({
                btnDragPos: instance._containerLeft
            });
            instance.setDragEvents();
        }
    },

    /**
     * Callback-fn for the onMouseMove-event.
     * Handles dragging of the button.
     *
     * @method handleMouseMove
     * @param e {Object} event-payload
     * @since 0.0.1
     */
    handleMouseMove(e) {
        let newPos;
        const instance = this;
        if (instance._mousedown) {
            instance._wasDragged = true;
            if (e.buttons===1) {
                newPos = instance._containerLeft + e.clientX - instance._mouseLeft;
                instance.setState({
                    btnDragPos: Math.max(2, Math.min(newPos, (instance._node.offsetWidth-instance._btnNode.offsetWidth-2))),
                    transitioned: false
                });
            } else {
                // mouse has been released outside the browser!
                instance.handleMouseUp();
            }
        }
    },

    /**
     * Callback-fn for the onMouseUp-event.
     * Finalizes button-dragging.
     *
     * @method handleMouseUp
     * @param noDetach {Boolean} to supress detaching the window-events, which are only set on desktop-devices
     * @since 0.0.1
     */
    handleMouseUp(noDetach) {
        let elementLeft, btnLeft, elementHalfWidth, btnHalfWidth, btnInsideLeftArea, stateChanged;
        const instance = this;
        (noDetach===true) || instance.detachDragEvents();
        instance._mousedown = false;
        // check if the position is beyond the &quot;state-change&quot;
        // if so, then switch the position
        if (instance.props.onChange) {
            elementLeft = domUtils.getNodeLeft(instance._node);
            btnLeft = domUtils.getNodeLeft(instance._btnNode);
            elementHalfWidth = instance._node.offsetWidth/2;
            btnHalfWidth = instance._btnNode.offsetWidth/2;
            btnInsideLeftArea = (btnLeft+btnHalfWidth) &lt; (elementLeft+elementHalfWidth);
            stateChanged = (instance.props.checked &amp;&amp; btnInsideLeftArea) || (!instance.props.checked &amp;&amp; !btnInsideLeftArea)
            stateChanged &amp;&amp; instance.props.onChange();
        }
        // reset state:
        instance.setState({
            btnDragPos: false,
            transitioned: true
        });
    },

    /**
     * Callback-fn for the onTouchMove-event.
     * Handles dragging of the button on mobile devices.
     *
     * @method handleTouchMove
     * @param e {Object} event-payload
     * @since 0.0.1
     */
    handleTouchMove(e) {
        const instance = this,
              newPos = instance._containerLeft + e.touches.clientX - instance._mouseLeft;
        instance.setState({
            btnDragPos: Math.max(0, Math.min(newPos, (instance._constrainNode.offsetWidth-instance._node.offsetWidth))),
            transitioned: false
        });
    },

    /**
     * Callback-fn for the onTouchStart-event.
     * Prepares for dragging the button on mobile devices.
     *
     * @method handleTouchStart
     * @param e {Object} event-payload
     * @since 0.0.1
     */
    handleTouchStart(e) {
        const instance = this;
        instance._containerLeft = domUtils.getNodeLeft(instance._containerNode) - domUtils.getNodeLeft(instance._constrainNode);
        instance._mouseLeft = e.touches.clientX;
        instance.setState({
            btnDragPos: instance._containerLeft
        });
    },

    /**
     * Sets some window-eventlisteners.
     *
     * @method setDragEvents
     * @chainable
     * @since 0.0.1
     */
    setDragEvents() {
        if (IE8_Events) {
            window.attachEvent(ON+MOUSEMOVE, this.handleMouseMove);
            window.attachEvent(ON+MOUSEUP, this.handleMouseUp);
        }
        else {
            window.addEventListener(MOUSEMOVE, this.handleMouseMove, true);
            window.addEventListener(MOUSEUP, this.handleMouseUp, true);
        }
        return this;
    }

};

export default checkboxEvents;

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
